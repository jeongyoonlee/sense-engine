## The Sense Platform dashboard creation utilities

This package gives you everything you need to run your favorite programming language or console-based application as a dashboard on [the Sense Platform](senseplatform.com)'s cloud infrastructure, using the same user interface as the officially-supported dashboards. 

User-defined dashboards are [npm](npmjs.org) modules that export a single function, which complies with the specification documented below. Their package.json files must have an entry called `sense`. There are three example dashboards to get you started in the examples folder.

To deploy a custom dashboard, simply stick it in `/home/sense/node_modules` in one of your projects. When you launch dashboards from that project in the future, the new dashboard type will be available in the drop-down menu.

### The exported function

The function your dashboard module exports should take a single argument, which will be a dashboard instance, and add the following attributes to it:

```javascript
module.exports = function(dashboard) {

  dashboard.worker =  # A child process launched using Node's 
                      # child_process.spawn, child_process.fork 
                      # or another utility. All dashboards must
                      # spawn a worker process so that the 
                      # parent process stays free to listen to 
                      # incoming events.

  dashboard.complete = function(string) {
    # Returns an array of completions
  }

  dashboard.chunk = function(codeString) {
    # Splits the code up into chunks, which may be statements, 
    # comments, etc. and returns them in an array. These chunks
    # will be sent to dashboard.execute one at a time.
  }

  dashboard.interrupt = function() {
    # Returns nothing, but interrupts the worker process somehow.
  }

  dashboard.execute = function(chunk, next) {
    # This function should send one chunk output by dashboard.chunk
    # to the worker process for execution, and then should call 
    # 'next' once the execution is complete and any result has been
    # passed to one of the output methods documented below. 'next' 
    # can be called asynchronously from a callback if that is easier.
  }

};
```

The following output methods of the dashboard can be called at any time to handle output from the worker process. In particular, the execute function can output any result or error associated with a chunk of code. It can also output comment chunks as plain text, and markdown-formatted comments as html.

```
# Display the string as plain text output.
dashboard.text(string)

# Display the string as an error.
dashboard.error(string)

# Display the string as a warning.
dashboard.warning(string)

# The string is a comment that was passed into the dashboard.
# Display it as comment-colored text.
dashboard.comment(string)

# The string is HTML that was generated by compiling Markdown.
# Display it as such.
dashboard.markdown(string)

# The string is a nonstandard prompt that the dashboard has 
# presented.
dashboard.prompt(string)

# The string is HTML and should be displayed as such.
dashboard.html(string)

# The string is a Javascript widget that should be embedded in
# the output.
dashboard.widget(string)
```

### The `sense` entry in package.json

The `sense` entry signals that your dashboard is in fact a dashboard, tells the UI what name to give it in the dashboard types menu, tells it how to highlight code typed into the dashboard, etc. For example:

```javascript
{
  ...,
  "sense": {
    "name": "CustomDashboard",
    "mode": "my-language",
    "fileExtensions": ["cd", "custdash", "customdashboard"],
    "lineComment": ""
  }
}
```

### Debugging from the command line

If your dashboard fails to launch on Sense, we'll do our best to report the error to you; but it's much easier to run your dashboard from a local command line while developing and debugging it, and then deploy to Sense after you're pretty sure it works.

To do this, type 

```javascript
require('sense-dashboard').cli(dashboardModuleName)
```

into node.js. All the dashboards in the examples folder have executable command-line versions in their `bin` folders.